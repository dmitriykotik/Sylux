# Sylux
Это простейшое ядро. Из пакета оно почти ничего не умеет. Автор будет продолжать доводить ядро до ума, но вы можете помочь в развитии проекта ядра Sylux. Напишите мне на почту, если хотите лично помогать в развитии проекта (на волонтёрской основе), или используйте "Pull requests" :D. 

> [!NOTE]
> Если у вас возникнут проблемы с компиляцией ядра, то отпишитесь мне на почту, я попробую помочь с проблемой, но не обещаю, что смогу.

> Почта: multiplayerdeveloper@gmail.com

> Автор: Плюха (Дмитрий Некраш) - https://www.youtube.com/@pluhaoff/

# Означение файлов и структура Sylux
- boot [folder] - Загрузчик ядра
  - bootsect.asm [file] - Загружает ядро в 32-х битном защищённом режиме
  - disk_load.asm [file] - Читает диск
  - gdt.asm [file] - Глобальная таблица дескриптеров
  - kernel_entry.asm [file] - Входная точка для ядра
  - print_hex.asm [file] - Вывод шестнадцатеричного числа на экран
  - print_string.asm [file] - Вывод строки на экран
  - print_string_pm.asm [file] - Вывод строки на экран в 32-х битном защищённом режиме
  - switch.asm [file] - Переключение в защищённый режим
- build [folder] - Сборщик
  - itm [folder] - Встроенный компилятор (gcc, ld) (без nasm и qemu)
    - bin [folder]
      - <...>
    - i386-elf [folder]
      - <...>
    - include [folder]
      - <...>
    - lib [folder]
      - <...>
    - libexec [folder]
      - <...>
    - share [folder]
      - <...>
  - Makefile [file] - Файл сборки
- drivers [folder] - Драйвера
  - acpi_reboot.c [file] - Перезагрузка компьютера
  - acpi_reboot.h [file] 
  - keyboard.c [file] - Работа с клавиатурой
  - keyboard.h [file]
  - lowlevel_io.c [file] - Низкоуровневый доступ
  - lowlevel_io.h [file]
  - screen.c [file] - Работы с экраном
  - screen.h [file]
- include [folder] - Библиотеки
  - inter.c [file] - Библиотека прерываний
  - inter.h [file]
  - keyboard_drv.c [file] - Драйвер клавиатуры
  - keyboard_drv.h [file]
  - logic.c [file] - Логика (которой не существует :D)
  - logic.h [file]
- kernel [folder] - Ядро
  - dos.c [file] - Дос (по умолчанию не активно)
  - dos.h [file]
  - kernel.c [file] - Полузагрузчик. Что-то между загрузчиком и меню выбора ОС
- common.c [file] - Всякие полезные функции,константы и т.д.
- common.h [file]

# Необходимые инструменты
1. Linux (возможно, можно любой, но ядро собирается на kali linux полной сборки [Kali Linux | Everything](https://www.kali.org/get-kali/#kali-installer-images))
2. GCC => В комплекте. Если не работает инструмент из коробки, то попробуйте скачать так:
```
wget http://newos.org/toolchains/i386-elf-4.9.1-Linux-x86_64.tar.xz
mkdir /usr/local/i386elfgcc
tar -xf i386-elf-4.9.1-Linux-x86_64.tar.xz -C /usr/local/i386elfgcc --strip-components=1
export PATH=$PATH:/usr/local/i386elfgcc/bin
```
4. LD => В комплекте.
5. NASM
6. QEMU - Установите так:
`sudo apt install qemu-kvm qemu`

# Загрузка, сборка и запуск
1. Скачиваем все инструменты выше.
2. (В идеале получаем рут права)
3. Скачиваем само ядро `git clone https://github.com/dmitriykotik/Sylux.git`
4. Редактируйте, что вам нужно или переходите сразу к 5 шагу
5. Переходим в папку build. Открываем в этой папке термина. И пишем: `make`
6. Таким образом у нас собирётся ядро и запустится в QEMU.
7. Если у вас не открылся QEMU с ядром, то попробуйте запустить в ручную: `qemu-system-i386 -fda sylux.bin`
> [!WARNING]  
> Если вы немного не понимаете как работает ядро, то это для вас: Если вы захотите создать новую папку в которой будут файлы (файлы на C языке конечно же) с зависимостями, то укажите эту папку в компиляции ядра. Тоесть, если в "make" файле прописанно `C_FILES = $(shell find ../kernel/*.c ../drivers/*.c ../*.c ../include/*.c)`, а вы хотите добавить папку "rabotaet_na_mena", то допишите папку так: `C_FILES = $(shell find ../kernel/*.c ../drivers/*.c ../*.c ../include/*.c ../rabotaet_na_mena/*.c)`, тоесть мы просто добавили `../rabotaet_na_mena/*.c`

> [!WARNING]
> Также, если вы хотите компилировать другой тип файлов, то нельзя указывать их в `C_FILES`! Также, если вы сменили расположение файла сборки, то тут всё сложнее.

> [!WARNING]
> Официальный сборщик ядра доступен только на Линукс, так что обращайте внимание на регистер слов!

> [!NOTE]
> Если у вас не получается скомпилировать ядро, или хотите сообщить о баге, то напишите мне на почту: `multiplayerdeveloper@gmail.com`

# Документация на текущие драйвера
> [!IMPORTANT]
> На данный момент (18.09.2023) документация может быть частично не доделана или полностью не доделана.

## Driver ./drivers/screen.c
### kprint_colored
```C
void kprint_colored(u8 *str, u8 attr);
```
`u8 *str` - Отображаемый текст.

`u8 attr` - Код цветовой схемы.

Пример: 
```C
kprint_colored("Hello World!", 0x04);
```
Описание: Выводит текст в определённой цветовой схеме

> [!NOTE]
> Цветовую схему можно использовать как 0x Твет фона текста и Цвет текста. Например: В примере выше использовалась цветовая схема 0x04, тоесть чёрный фон текста и красный цвет текста, тоесть после 0x где 0 там чёрный цвет, а где 4 там красный. Снизу я напишу таблицу.

| LEFT | CENTER | RIGHT |
|----------------|:---------:|----------------:|
| По левому краю | По центру | По правому краю |
| текст | текст | текст |
